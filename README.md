# AT USER API

Микросервис пользователей AT-ТЕХНОЛОГИЯ

## Локальный запуск сервиса

### Поднятие сервиса для разработки

0. Инициализировать виртуальное окружение `poetry` и установить все нужные библиотеки. 

1. Перейти в директорию `local`.

2. Инициализировать переменные окружения согласно файлу `.env.example`.

3. Выполнить команду `docker compose up -d`, в результате чего будут запущены все требуемые зависимости
в docker-контейнерах с параметрами, которые описывались в п.2.

4. Если это первый запуск проекта, необходимо выполнить миграцию схемы БД.
    1. Перейти в директорию `local/migrations`.
    2. Выполнить команду `bash upgrade_head.sh`.

5. Выполнить команду `bash local.sh` в директории `local`.

### Поднятие сервиса для использования в других сервисах

1. Предполагается, что зависимости уже созданы:
    1. RabbitMQ.
    2. [AT Queue](https://github.com/grigandal625/AT_QUEUE).
    3. Postgres DB для данных пользователей.

2. Выполнить запуск в с помощью команды `python -m at_user_api`.
    1. Передача параметров запуска с помощью аргументов командной строки (см. справку `python -m at_user_api -h`).

    2. Передача параметров запуска с помощью переменных окружения (см. локальный запуск).